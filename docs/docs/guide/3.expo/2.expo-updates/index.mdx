# ExpoUpdates

cloud-push is **compatible** with [`expo-updates`](https://docs.expo.dev/technical-specs/expo-updates-1/) and supports the following settings.

## install

```bash
pnpm expo install expo-updates
```

## üìò Expo Updates SDK Compatibility

### üß± Constants

| Constant                        | Supported |
| ------------------------------- | --------- |
| `Updates.channel`               | ‚úÖ        |
| `Updates.checkAutomatically`    | ‚úÖ        |
| `Updates.createdAt`             | ‚úÖ        |
| `Updates.emergencyLaunchReason` | ‚è≥        |
| `Updates.isEmbeddedLaunch`      | ‚úÖ        |
| `Updates.isEmergencyLaunch`     | ‚è≥        |
| `Updates.isEnabled`             | ‚úÖ        |
| `Updates.latestContext`         | ‚úÖ        |
| `Updates.launchDuration`        | ‚úÖ        |
| `Updates.manifest`              | ‚úÖ        |
| `Updates.runtimeVersion`        | ‚úÖ        |
| `Updates.updateId`              | ‚úÖ        |

### üß© Hooks

| Hook           | Supported |
| -------------- | --------- |
| `useUpdates()` | ‚úÖ        |

### üõ† Methods

| Method                   | Supported |
| ------------------------ | --------- |
| `checkForUpdateAsync()`  | ‚úÖ        |
| `clearLogEntriesAsync()` | ‚úÖ        |
| `fetchUpdateAsync()`     | ‚úÖ        |
| `getExtraParamsAsync()`  | ‚ùå        |
| `readLogEntriesAsync()`  | ‚úÖ        |
| `reloadAsync()`          | ‚úÖ        |
| `setExtraParamAsync()`   | ‚ùå        |

---

## app.json / app.config.ts

Most options in [`app.json or app.config.ts updates`](https://docs.expo.dev/versions/latest/config/app/#updates) are supported.

### ‚úÖ Supported settings

| Option                   | Description                           |
| ------------------------ | ------------------------------------- |
| `enabled`                | Whether to enable the update system   |
| `checkAutomatically`     | How to check for updates at app start |
| `useEmbeddedUpdate`      | Whether to use embedded updates       |
| `fallbackToCacheTimeout` | Update response wait time (ms)        |
| `url`                    | Remote URL for the update manifest    |
| `requestHeaders`         | Custom headers to include in requests |

These settings work **properly** in the Expo SDK and guarantee predictable behavior in both JS and native builds.

---

### ‚ö†Ô∏è Unsupported or uncertain settings

| Option                        | Supported        | Description                                          |
| ----------------------------- | ---------------- | ---------------------------------------------------- |
| `codeSigningCertificate`      | ‚ùå Not supported | Code signing is not yet enabled in the SDK.          |
| `codeSigningMetadata`         | ‚ùå Not supported | Likewise, ignored.                                   |
| `assetPatternsToBeBundled`    | ‚ö†Ô∏è Not confirmed | May not work in some environments.                   |
| `disableAntiBrickingMeasures` | ‚ö†Ô∏è Not confirmed | Can be set, but it's unclear if it actually applies. |

> ‚ùóÔ∏è **Caution:** `disableAntiBrickingMeasures` can make your app unbootable, so **do not use in production environments**.

---

If you're **not using EAS Build**, set the update URL and headers manually:

```diff
  updates: {
-    url: "https://u.expo.dev/"
+    url: "https://your-server-domain/api/manifest",
+    requestHeaders: {
+      "expo-channel-name": process.env.APP_VARIANT,
+    },
  },
```

<details>
  <summary>üõ†Ô∏è If you're using EAS Build</summary>

You don't need to manually set `requestHeaders`. Instead, configure the channel in `eas.json`:

```json
{
  "build": {
    "production": {
      "channel": "stable"
    },
    "preview": {
      "channel": "beta"
    }
  }
}
```

> In this example, builds triggered with the `--profile preview` option will use the `beta` channel, while `--profile production` uses `stable`.

</details>

---

### Example settings

```ts
updates: {
  enabled: true,
  checkAutomatically: 'ON_LOAD',
  fallbackToCacheTimeout: 10000,
  useEmbeddedUpdate: true,
  url: 'https://my-updates.example.com',
  requestHeaders: {
    'x-custom-header': 'value',
  },
}
```
