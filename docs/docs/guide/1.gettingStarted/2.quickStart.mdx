# Quick Start

Start using `cloud-push` in two parts: the **server** and the **expo client**.

## üì° Server Setup

### 1Ô∏è‚É£ Create server project

```bash
pnpm create next-app --yes
```

### 2Ô∏è‚É£ Install the packages

```bash
pnpm add @cloud-push/next @cloud-push/cloud @cloud-push/utils @tanstack/react-query semver @types/semver
```

### 3Ô∏è‚É£ Initialize server apis

```bash
npx @cloud-push/cli next-init
```

### 4Ô∏è‚É£ Run server

```
pnpm dev
```

## üì± Expo Client Setup

> **Recommended:** Use **Node.js v18+** and **Expo SDK 52+** for best compatibility.

### 1Ô∏è‚É£ Install the packages

```bash
pnpm add @cloud-push/expo @cloud-push/cloud @cloud-push/cli
```

### 2Ô∏è‚É£ Initialize config

```bash
pnpm cloud-push expo-init
```

### 3Ô∏è‚É£ Modify your `app.json` or `app.config.ts`

If you're **not using EAS Build**, set the update URL and headers manually:

```diff
  updates: {
-    url: "https://u.expo.dev/"
+    url: "https://your-server-domain/api/manifest",
+    requestHeaders: {
+      "expo-channel-name": process.env.APP_VARIANT,
+    },
  },
```

<details>
  <summary>üõ†Ô∏è If you're using EAS Build</summary>

You don't need to manually set `requestHeaders`. Instead, configure the channel in `eas.json`:

```json
{
  "build": {
    "production": {
      "channel": "stable"
    },
    "preview": {
      "channel": "beta"
    }
  }
}
```

> In this example, builds triggered with the `--profile preview` option will use the `beta` channel, while `--profile production` uses `stable`.

</details>
```

### 4Ô∏è‚É£ Provide environment variables

Set variables in `.env` or use **EAS Secrets**:

```env
SUPABASE_URL=...
SUPABASE_KEY=...
SUPABASE_BUCKET_NAME=...
```

> ‚úÖ Provide appropriate values for AWS, Supabase, or Firebase depending on your storage backend.

### 5Ô∏è‚É£ Deploy the update

```bash
pnpm cloud-push deploy
```

> üí° OTA updates will only apply to builds with the same `runtimeVersion`

<details>

<summary>üîß Local Environment Testing Notes</summary>

## ‚ö†Ô∏è Android Cleartext Warning

To allow HTTP requests on Android, you need to set `usesCleartextTraffic`.

```ts
export default {
  expo: {
    name: "your-app-name",
    slug: "your-app-slug",
    plugins: [
      [
        "expo-build-properties",
        {
          android: {
            usesCleartextTraffic: true,
          },
          ios: {},
        },
      ],
    ],
  },
};
```

</details>
